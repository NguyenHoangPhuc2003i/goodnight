<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pink Hearts ‚Äî Goodnight</title>
  <style>
    :root{
      --bg1:#ffd1dc;  /* h·ªìng nh·∫°t */
      --bg2:#ff9bb3;  /* h·ªìng ƒë·∫≠m */
      --text:#fff;
      --glow:#ff5a8a;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      background: radial-gradient(1100px 800px at 50% 15%, var(--bg1), var(--bg2));
      overflow:hidden; font-family: system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      color:var(--text);
    }

    /* n·ªÅn l·∫•p l√°nh nh·∫π */
    .sparkle,.sparkle:after{
      position:fixed; inset:-200px; content:""; pointer-events:none;
      background:
        radial-gradient(2px 2px at 20% 30%, #fff4 80%, transparent 81%) repeat,
        radial-gradient(1.5px 1.5px at 70% 60%, #fff3 80%, transparent 81%) repeat,
        radial-gradient(1px 1px at 40% 80%, #fff3 80%, transparent 81%) repeat;
      background-size: 520px 520px, 640px 640px, 760px 760px;
      animation: floatBg 28s linear infinite;
      filter: blur(.3px);
    }
    .sparkle:after{ animation-duration: 40s; opacity:.8 }
    @keyframes floatBg{ from{transform:translateY(0)} to{transform:translateY(-220px)} }

    /* l·ªõp y√™u c·∫ßu xoay ngang */
    .rotate-overlay{
      position:fixed; inset:0; display:none; align-items:center; justify-content:center;
      text-align:center; padding:24px; background:#0008; color:#fff; z-index:9999;
    }
    .rotate-overlay .box{
      padding:20px 24px; border-radius:16px; background:#0006; border:1px solid #ffffff44;
      backdrop-filter: blur(8px); box-shadow:0 10px 40px #0006;
    }
    .rotate-overlay h2{margin:0 0 8px}
    .rotate-overlay p{margin:0; opacity:.9}
    @media (orientation:portrait){
      .rotate-overlay{ display:flex }
      .content{ filter: blur(3px); }
    }

    /* v√πng n·ªôi dung */
    .content{position:relative; height:100%; display:grid; place-items:center}

    /* ch·ªØ typing (loop) */
    #title{
      max-width:92vw;
      white-space:nowrap; overflow:hidden; border-right:3px solid rgba(255,255,255,.85);
      font-size:clamp(30px, 7vw, 64px);
      text-shadow:0 0 10px var(--glow), 0 0 30px var(--glow);
    }

    /* n√∫t nh·∫°c */
    #musicBtn{
      position:fixed; left:50%; bottom:20px; transform:translateX(-50%);
      padding:12px 18px; border:0; border-radius:999px; font-weight:700;
      background:#ffffffd0; color:#c4145a; cursor:pointer;
      box-shadow:0 10px 26px #c4145a55; backdrop-filter: blur(8px);
    }

    /* tr√°i tim ‚Äúch√≠u ch√≠u‚Äù l·ªõn h∆°n + v·ªát s√°ng */
    .heart{
      position:fixed; width:34px; height:34px; transform:rotate(45deg);
      background:#ff2e63; filter: drop-shadow(0 0 10px #ff2e63aa) saturate(1.2);
      will-change: transform, opacity;
    }
    .heart:before,.heart:after{
      content:""; position:absolute; width:34px; height:34px; border-radius:50%;
      background:inherit; left:-17px; top:0;
    }
    .heart:after{ left:0; top:-17px }
    .trail{
      position:fixed; width:140px; height:3px;
      background:linear-gradient(90deg, #0000, #ff2e63aa, #0000);
      filter: blur(1px); opacity:.8; transform-origin:left center;
      will-change: transform, opacity, width;
    }
  </style>
</head>
<body>
  <div class="sparkle"></div>

  <!-- l·ªõp y√™u c·∫ßu xoay ngang -->
  <div class="rotate-overlay">
    <div class="box">
      <h2>üîÅ Vui l√≤ng xoay ngang (Landscape)</h2>
      <p>ƒê·ªÉ c·∫£m nh·∫≠n tr·ªçn v·∫πn nh√©!!! ‚ù§Ô∏è</p>
    </div>
  </div>

  <div class="content">
    <div id="title"></div>
  </div>

  <!-- audio MP3 tr·ª±c ti·∫øp: ƒë√°ng tin h∆°n YouTube -->
<!-- Nh·∫°c n·ªÅn -->
<audio id="bgm" preload="auto" loop>
  <source src="https://cdn.pixabay.com/download/audio/2023/07/31/audio_ef7b1.mp3?filename=good-night-lofi-cozy-chill-music-160166.mp3" type="audio/mpeg">
  Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ ph√°t nh·∫°c.
</audio>

<!-- N√∫t b·∫≠t/t·∫Øt nh·∫°c -->
<button id="musicBtn">üîä B·∫≠t nh·∫°c</button>

  <button id="musicBtn">üîä B·∫≠t nh·∫°c</button>

  <script>
    /* ========= C·∫•u h√¨nh nhanh ========= */
    // Nh·∫≠p message m·∫∑c ƒë·ªãnh ·ªü ƒë√¢y (s·∫Ω b·ªã override n·∫øu c√≥ ?msg= tr√™n URL)
    const DEFAULT_MSG = "Ch√∫c em b√© ng·ªß ngon üíñ";
    // t·ªëc ƒë·ªô g√µ & gi·ªØ
    const TYPE_SPEED = 55;       // ms m·ªói k√Ω t·ª±
    const HOLD_FULL  = 1500;     // d·ª´ng khi g√µ xong
    const ERASE_SPEED= 40;       // x√≥a nhanh h∆°n
    const HOLD_EMPTY = 400;      // d·ª´ng khi x√≥a h·∫øt

    // Cho ph√©p ƒë·∫∑t n·ªôi dung qua URL: ?msg=...
    const params = new URLSearchParams(location.search);
    const MESSAGE = params.get("msg") || DEFAULT_MSG;

    /* ========= Typing loop ========= */
    const title = document.getElementById("title");
    function typeLoop(text){
      let i = 0, dir = 1; // 1: typing, -1: erasing
      function tick(){
        title.textContent = text.slice(0, i);
        title.style.borderRight = "3px solid rgba(255,255,255,.85)";
        if (dir === 1) {
          if (i < text.length){ i++; setTimeout(tick, TYPE_SPEED); }
          else { title.style.borderRight = "3px solid transparent"; setTimeout(()=>{ dir = -1; tick(); }, HOLD_FULL); }
        } else {
          if (i > 0){ i--; setTimeout(tick, ERASE_SPEED); }
          else { title.style.borderRight = "3px solid rgba(255,255,255,.85)"; setTimeout(()=>{ dir = 1; tick(); }, HOLD_EMPTY); }
        }
      }
      tick();
    }
    typeLoop(MESSAGE);

    /* ========= Tr√°i tim ‚Äúch√≠u ch√≠u‚Äù ========= */
    function shootHeart(fromLeft=true){
      const startX = fromLeft ? -30 : innerWidth + 30;
      const startY = innerHeight + 30;
      const endX   = fromLeft ? innerWidth*0.8 + Math.random()*100 : innerWidth*0.2 - Math.random()*100;
      const endY   = innerHeight*0.18 + Math.random()*140;

      const angle = Math.atan2(endY - startY, endX - startX);
      const dur   = 1200 + Math.random()*900; // ms

      const trail = document.createElement('div');
      trail.className = 'trail';
      trail.style.left = (fromLeft ? startX : endX) + "px";
      trail.style.top  = (fromLeft ? startY : endY) + "px";
      trail.style.transform = `rotate(${angle*180/Math.PI}deg)`;
      document.body.appendChild(trail);

      const heart = document.createElement('div');
      heart.className = 'heart';
      document.body.appendChild(heart);

      const t0 = performance.now();
      function anim(t){
        const p = Math.min(1, (t - t0) / dur);
        const x = startX + (endX - startX) * p;
        const y = startY + (endY - startY) * p;
        heart.style.transform = `translate(${x}px,${y}px) rotate(45deg) scale(${1 + p*0.25})`;
        trail.style.width = 110 + p*170 + "px";
        trail.style.opacity = (1 - p) * 0.9;
        if (p < 1) requestAnimationFrame(anim);
        else { heart.remove(); trail.remove(); }
      }
      requestAnimationFrame(anim);
    }
    let fromLeft = true;
    setInterval(()=>{ shootHeart(fromLeft); fromLeft = !fromLeft; }, 260);

    /* ========= Nh·∫°c: c·∫ßn thao t√°c ng∆∞·ªùi d√πng ========= */
    const audio   = document.getElementById('bgm');
    const btn     = document.getElementById('musicBtn');
    let playing   = false;

    function updateBtn(){ btn.textContent = playing ? "‚è∏ T·∫Øt nh·∫°c" : "üîä B·∫≠t nh·∫°c"; }
    updateBtn();

    function tryPlay(){
      audio.play().then(()=>{ playing = true; updateBtn(); })
      .catch(()=>{ playing = false; updateBtn(); /* n·∫øu b·ªã ch·∫∑n, ch·ªù b·∫•m l·∫ßn n·ªØa */});
    }

    // l·∫ßn ch·∫°m ƒë·∫ßu ti√™n s·∫Ω play (mobile y√™u c·∫ßu gesture)
    btn.addEventListener('click', ()=>{
      if (!playing) tryPlay(); else { audio.pause(); playing = false; updateBtn(); }
    }, {passive:true});

    // iOS ƒë√¥i khi c·∫ßn 'touchstart' m·ªõi k√≠ch ho·∫°t
    window.addEventListener('touchstart', ()=>{}, {passive:true});
  </script>
</body>

<!-- L·ªöP Y√äU C·∫¶U XOAY NGANG: ch·ªâ hi·ªÉn th·ªã qua CSS @media (orientation:portrait) -->
</html>
